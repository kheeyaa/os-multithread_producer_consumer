운영체제 - POSIX pthread를 활용한 producer/ consumer 구현

(1) 2개의 producer thread P1, P2와 3개의 consumer thread C1, C2, C3를 생성한다.
(2) P1, P2는 stdin에서 입력되는 정수 값을 차례로 읽어들여, 공유 버퍼에 저장한다. 이 때, 같은 값을 버퍼에 중복 저장하지 않도록 유의.
(3) P1, P2는 표준 입력(stdin)에서 -999를 만날 때까지 위의 과정 (2)를 반복하고, -999를 만나면 입력 데이터가 끝났 음을 알게 한다. (EOF 대신 -999를 사용)
- 입력 값의 범위는 0 이상 1,000,000 이하이며, 최대 100,000개의 값 입력 예정
(4) 이 때, P1, P2는 각 입력 데이터를 읽은 후 각각 usleep(1000), usleep(2000)을 호출하여 잠깐씩 block하는 과정 을 반복한다.
(5) 각 C1, C2, C3는 buffer에서 한 개씩 데이터를 꺼내고, 각 값에 대해 다음 작업을 수행한다.
- 그 값을 전역변수 total에 더한다.
- 이 값이 속하는 범위에 따라 각 구간 count[i]를 증가시킨다. (각 count[i]는 10,000단위로 구간 지정)
count[0] : 0 ~ 9,999 count[1] : 10,000 ~ 19,999 ......
count[99] : 990,000 이상
* 주의: 같은 값을 중복해서 처리하지 않도록 주의한다.
(6) C1, C2, C3는 buffer에서 데이터를 꺼낸 후, 각각 usleep(3000). usleep(4000), usleep(5000)을 호출하여 잠깐씩 block하는 과정을 반복한다.
(7) 공유 버퍼는 int buffer[1000]으로 설정하고, circular 버퍼로 관리한다.
(8) 공유 파일, 공유 버퍼, 공유 변수 등에 접근할 때 POSIX mutex를 사용하여 critical section을 보호해야 한다.
